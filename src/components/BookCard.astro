---
import { type CollectionEntry } from 'astro:content';
import FormattedDate from './FormattedDate.astro';
import { Image } from 'astro:assets';

type Props = { book: CollectionEntry<'books'>; class?: string };

const { book, class: className } = Astro.props;
const { title, author, rating, dateRead, cover } = book.data;

// Generate star rating display
const stars = rating ? '⭐'.repeat(rating) : '';
---

<article class:list={["group relative h-full", className]}>
    <a href={`/books/${book.id}/`} class="absolute inset-0 z-10"></a>
    <div class="flex flex-col h-full rounded-xl border-2 border-[var(--border-main)] bg-[var(--bg-main)] p-6 transition-all hover:border-[var(--accent)] hover:shadow-lg hover:-translate-y-1">
        <div class="mb-4 flex items-start gap-4">
            {cover && (
                <div class="flex-shrink-0">
                    <Image
                        src={cover}
                        alt={`${title} cover`}
                        width={80}
                        height={120}
                        class="rounded shadow-md"
                    />
                </div>
            )}
            <div class="flex-grow">
                <h3 class="mb-2 font-serif text-xl font-medium leading-tight text-[var(--text-main)] group-hover:text-[var(--accent)] transition-colors">
                    {title}
                </h3>
                <p class="text-sm text-[var(--text-main)] opacity-75 mb-2">
                    by {author}
                </p>
                {rating && (
                    <div class="text-sm mb-2" title={`${rating} out of 5 stars`}>
                        {stars}
                    </div>
                )}
                {dateRead && (
                    <div class="text-xs text-[var(--accent-light)]">
                        Read: <FormattedDate date={dateRead} />
                    </div>
                )}
            </div>
        </div>
        
        <div class="mt-auto pt-4 border-t border-[var(--border-main)] text-right">
            <span class="text-xs font-handwritten text-[var(--accent)]">View book →</span>
        </div>
    </div>
</article>


