---
import { type CollectionEntry } from 'astro:content';
import ArrowRight from '../assets/icons/arrow-right.svg';
import FormattedDate from './FormattedDate.astro';

type Props = { post: CollectionEntry<'blog'>; class?: string; headingLevel?: 'h2' | 'h3' };

const { post, class: className, headingLevel = 'h2' } = Astro.props;
const { title, publishDate, updatedDate, excerpt, status } = post.data;
const TitleTag = headingLevel;
---

<article class:list={['group relative', className]}>
    <a href={`/blog/${post.id}/`} class="absolute inset-0 z-10"></a>
    <div class="flex flex-col gap-3 p-6 rounded-lg border border-[var(--border-main)] bg-[var(--bg-main)] hover:border-[var(--accent)] hover:shadow-sm transition-all">
        <div class="flex items-start justify-between">
            <div class="grow">
                <TitleTag
                    class="font-serif text-2xl leading-tight font-medium text-[var(--text-main)] group-hover:text-[var(--accent)] transition-colors sm:text-3xl"
                >
                    {title}
                </TitleTag>
                <div class="mt-2 text-sm text-[var(--accent-light)] flex items-center gap-3">
                    <span class="flex items-center gap-1">
                        <span class="text-lg">{status?.split(' ')[0] || 'ðŸŒ±'}</span>
                        <FormattedDate date={publishDate} />
                    </span>
                    {updatedDate && (
                        <span class="text-xs italic">
                            (Updated <FormattedDate date={updatedDate} />)
                        </span>
                    )}
                </div>
            </div>
            <div class="hidden font-serif italic text-[var(--accent)] opacity-0 transition group-hover:opacity-100 sm:inline-flex sm:shrink-0 sm:items-center sm:gap-1">
                Read <ArrowRight class="h-4 w-4 fill-current ml-1" />
            </div>
        </div>
        {excerpt && (
            <div class="mt-4 text-sm leading-relaxed text-[var(--text-main)] opacity-90">
                {excerpt}
            </div>
        )}
        <div class="mt-4 pt-4 border-t border-[var(--border-main)]">
            <span class="text-xs font-handwritten text-[var(--accent)]">Click to read â†’</span>
        </div>
    </div>
</article>
