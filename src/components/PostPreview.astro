---
import { type CollectionEntry } from 'astro:content';
import FormattedDate from './FormattedDate.astro';

type Props = { post: CollectionEntry<'blog'>; class?: string; headingLevel?: 'h2' | 'h3' };

const { post, class: className, headingLevel = 'h2' } = Astro.props;
const { title, publishDate, updatedDate, excerpt, status, tags } = post.data;
const TitleTag = headingLevel;

// Maggie Appleton Style: Growth Icons based on status field (blog collection uses emoji + label)
const icon = status?.split(' ')[0] || 'ðŸŒ±';
---

<article class="group relative h-full">
    <a href={`/blog/${post.id}/`} class="absolute inset-0 z-10"></a>
    <div class="flex flex-col h-full rounded-xl border-2 border-[var(--border-main)] bg-[var(--bg-main)] p-6 transition-all hover:border-[var(--accent)] hover:shadow-lg hover:-translate-y-1">
        <div class="mb-4 flex items-center justify-between">
            <span class="text-3xl">{icon}</span>
            <span class="text-xs font-serif italic text-[var(--accent-light)]">
                <FormattedDate date={publishDate} />
                {updatedDate && (
                    <span class="ml-1">
                        (Updated <FormattedDate date={updatedDate} />)
                    </span>
                )}
            </span>
        </div>
        
        <TitleTag class="mb-3 font-serif text-2xl font-medium leading-tight text-[var(--text-main)] group-hover:text-[var(--accent)] transition-colors">
            {title}
        </TitleTag>

        {excerpt && (
            <p class="mb-6 flex-grow text-sm leading-relaxed text-[var(--text-main)] opacity-90 line-clamp-3">
                {excerpt}
            </p>
        )}

        {tags.length > 0 && (
            <div class="mt-auto flex flex-wrap gap-2">
                {tags.slice(0, 3).map(tag => (
                    <span class="text-xs font-medium px-3 py-1 rounded-full bg-[var(--bg-muted)] text-[var(--accent)] border border-[var(--border-main)]">
                        {tag}
                    </span>
                ))}
            </div>
        )}
        <div class="mt-6 pt-4 border-t border-[var(--border-main)] text-right">
            <span class="text-xs font-handwritten text-[var(--accent)]">Read post â†’</span>
        </div>
    </div>
</article>
