---
import { marked } from 'marked';
import type { Hero as HeroProps } from '../types';
import Button from './Button.astro';
import CustomImage from './CustomImage.astro';

type Props = HeroProps;

const { title, image, text, actions } = Astro.props;
---

{
    (title || image?.src || text || (actions && actions.length > 0)) && (
        <section class="mb-20 flex w-full flex-col gap-10 sm:mb-28">
            {title && (
                <div class="mx-auto w-full max-w-4xl px-4 md:px-8">
                    <h1 class="font-serif text-4xl leading-tight font-medium sm:text-6xl sm:leading-tight text-center">
                        {title}
                        <span class="block mt-4 text-xl sm:text-2xl text-[var(--accent)] font-normal">
                            A Website by Ab
                        </span>
                    </h1>
                </div>
            )}
            
            {image?.src && (
                <figure class="w-full max-w-2xl mx-auto rounded-2xl overflow-hidden border border-[var(--border-main)] shadow-lg">
                    <CustomImage
                        class="mx-auto h-auto w-auto max-w-full object-contain"
                        {...image}
                        widths={[480, 640, 768, 1024, 1536, 1920]}
                        sizes="100vw"
                        fetchpriority="high"
                        loading="eager"
                    />
                    {image.caption && (
                        <div class="mx-auto w-full max-w-3xl px-4 md:px-8">
                            <figcaption class="mt-3 text-sm text-[var(--accent-light)] text-center">{image.caption}</figcaption>
                        </div>
                    )}
                </figure>
            )}

            {(text || (actions && actions.length > 0)) && (
                <div class="mx-auto w-full max-w-3xl px-4 md:px-8 flex flex-col gap-10 items-center">
                    {text && <div class="prose sm:prose-lg max-w-none text-center text-pretty" set:html={marked.parse(text)} />}
                    {actions && actions.length > 0 && (
                        <div class="flex flex-wrap gap-6 justify-center">
                            {actions.map((action) => (
                                <Button href={action.href} variant="filled">{action.text}</Button>
                            ))}
                        </div>
                    )}
                    <div class="w-full max-w-xs h-px bg-gradient-to-r from-transparent via-[var(--border-main)] to-transparent"></div>
                </div>
            )}
        </section>
    )
}